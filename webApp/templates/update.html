{% extends 'base.html' %}

{% block title %} Edytuj produkt {% endblock %}

{% block extrahead %}
<link rel="stylesheet" href="{{url_for('static', filename='styles/update.css')}}">
{% endblock %}

{% block main %} 

  {% if request.args['product']%}
  <br>
  <br>
  produkt - {{prd.name}}
  <br>
  <br>
  {% from "_formhelpers.html" import render_field %}
  <form method="post" enctype="multipart/form-data">
    <dl>
      {{ render_field(form.name) }}
      {{ render_field(form.image) }}
      {{ render_field(form.category) }}
      {{ render_field(form.price) }}
      {{ render_field(form.description) }}
      {{ render_field(form.quantity) }}
    </dl>
    <p><input type=submit value=Add>
  </form>
  {% endif %}

  <div class="img-preview"></div>

  {% with messages = get_flashed_messages() %}
  {% if messages %}
  <ul class=flashes>
    {% for message in messages %}
      <p style="color: red;">{{ message }}</p>
    {% endfor %}
    </ul>
  {% endif %}
{% endwith %}

<script>
$(document).ready(function(){
  let ff15 = $('input').parent()[2];
  ff15.innerHTML += `<img class="zdjencie" src="{{url_for('static', filename=image)}}"></img>`;
  $('#name').val('{{prd.name}}');
  $('#category').val($('#category').children()['{{prd.category}}'-1].innerHTML);
  $('#price').val('{{prd.price}}');
  $('#description').val(`{{prd.description}}`);
  $('#quantity').val('{{prd.quantity}}');


  $('.zdjencie').click(function() {
    $('#image').click();
  });

  
  $('#image').change(function() {
    var uploaded_images = '';
    // alert($('#image').val());
    const reader = new FileReader();
    reader.addEventListener('load', () => {
      uploaded_images = reader.result;
      $('.zdjencie').attr('src', uploaded_images)
    })
    reader.readAsDataURL(this.files[0]);
  })
});

</script>

{% endblock %}