<!DOCTYPE html>
<html>
  <head>
    <title>Default Page</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static',filename='styles/index.css') }}"
    />
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script>
      $(document).ready(function () {
        $("#livebox").on("input", function (e) {
          $("#datalist").empty();
          $.ajax({
            method: "post",
            url: "/livesearch",
            data: { text: $("#livebox").val() },
            success: function (res) {
              var data = "<div class='list-group'>";
              $.each(res, function (index, value) {
                data +=
                  "<p class='list-group-item list-group-item-action'><a href=" +
                  "'/profile/" +
                  value.user +
                  "?product=" +
                  value.name +
                  "'" +
                  ">" +
                  value.name +
                  "</a></p>";
              });
              data += "</div>";
              $("#datalist").html(data);
            },
          });
        });
        $("#livebox").on("click", function (event) {
          $("#datalist").empty();
          $.ajax({
            method: "post",
            url: "/livesearch",
            data: { text: $("#livebox").val() },
            success: function (res) {
              var data = "<div class='list-group'>";
              $.each(res, function (index, value) {
                data +=
                  "<p class='list-group-item list-group-item-action'><a href=" +
                  "'/profile/" +
                  value.user +
                  "?product=" +
                  value.name +
                  "'" +
                  ">" +
                  value.name +
                  "</a></p>";
              });
              data += "</div>";
              $("#datalist").html(data);
            },
          });
        });
        $(document).on("click", function (event) {
          if (!$(event.target).closest("#search").length) {
            $("#datalist").empty();
          }
        });
      });
    </script>
  </head>
  <body class="bg-dark">
    <div class="fsakjfj">
      <nav class="navbar navbar-expand-md bg-dark navbar-dark">
        <a class="navbar-brand" href="#">Wendki</a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#collapsibleNavbar"
        >
          <span class="navbaar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse lfaslfasl" id="collapsibleNavbar">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="/logout">logout</a>
            </li>
            <li class="nav-item">
              <a href="/" class="nav-link">Default Page</a>
            </li>
          </ul>
        </div>
        {% if current_user.is_authenticated %}
        <div class="account">
          <h4 class="account-name">{{ current_user.username }}</h4>
          <a href="/logout">
            <button>LogOut</button>
          </a>
          <a href="/dashboard">
            <button>Your Profille</button>
          </a>
        </div>
        {% else %}
        <div class="account">
          <button><a href="/login">login</a></button>
          <button><a href="/register">register</a></button>
        </div>
        {% endif %}
      </nav>
    </div>
    <div class="container">
      <p></p>
      <div class="search">
        <input
          type="text"
          id="livebox"
          name="text"
          class="form-control"
          placeholder="Find products"
          autocomplete="off"
        />
        <p id="datalist"></p>
      </div>
    </div>
  </body>
</html>
